<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>T-Shirt Store</title>
    <style>
      /* Global Styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background-color: #f5f5f5;
        color: #333;
        line-height: 1.6;
      }

      .container {
        width: 90%;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      /* Header Styles */
      header {
        background-color: #2c3e50;
        color: white;
        padding: 15px 0;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .logo {
        font-size: 1.8rem;
        font-weight: bold;
        font-family: sans-serif;
      }

      nav ul {
        display: flex;
        list-style: none;
      }

      nav ul li {
        margin-left: 20px;
      }

      nav ul li a {
        color: white;
        text-decoration: none;
        padding: 5px 10px;
        border-radius: 3px;
        transition: background-color 0.3s;
      }

      nav ul li a:hover {
        background-color: rgba(255, 255, 255, 0.1);
      }

      nav ul li a.active {
        background-color: #3498db;
      }

      /* Main Content Styles */
      main {
        min-height: calc(100vh - 140px);
        padding: 30px 0;
      }

      .page {
        display: none;
      }

      .page.active {
        display: block;
      }

      /* Store Page Styles */
      .page-title {
        text-align: center;
        margin-bottom: 30px;
        color: #2c3e50;
      }
      #store .iden {
        text-align: center;
        margin-bottom: 30px;
        color: #2c3e50;
        font-size: 20px;
        font-family: sans-serif;
        font-style: bold;
      }

      .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 25px;
      }

      .product-card {
        background-color: white;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s, box-shadow 0.3s;
      }

      .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
      }

      .product-image {
        width: 100%;
        height: 250px;
        object-fit: cover;
        background-color: #f8f9fa;
      }

      .product-info {
        padding: 15px;
      }

      .product-title {
        font-size: 1.2rem;
        margin-bottom: 8px;
      }

      .product-price {
        font-weight: bold;
        color: #e74c3c;
        font-size: 1.1rem;
        margin-bottom: 10px;
      }

      .product-description {
        color: #7f8c8d;
        font-size: 0.9rem;
        margin-bottom: 15px;
      }

      .add-to-cart {
        background-color: #3498db;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 4px;
        cursor: pointer;
        width: 100%;
        font-size: 1rem;
        transition: background-color 0.3s;
      }

      .add-to-cart:hover {
        background-color: #2980b9;
      }

      /* Admin Page Styles */
      .admin-form {
        background-color: white;
        padding: 25px;
        border-radius: 8px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        max-width: 600px;
        margin: 0 auto 40px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
      }

      input,
      textarea,
      select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 1rem;
      }

      textarea {
        height: 100px;
        resize: vertical;
      }

      .form-buttons {
        display: flex;
        justify-content: space-between;
      }

      .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 1rem;
        transition: background-color 0.3s;
      }

      .btn-primary {
        background-color: #3498db;
        color: white;
      }

      .btn-primary:hover {
        background-color: #2980b9;
      }

      .btn-secondary {
        background-color: #95a5a6;
        color: white;
      }

      .btn-secondary:hover {
        background-color: #7f8c8d;
      }

      .btn-danger {
        background-color: #e74c3c;
        color: white;
      }

      .btn-danger:hover {
        background-color: #c0392b;
      }

      /* Additional styles for image upload */
      #image-preview,
      #url-preview {
        text-align: center;
        padding: 10px;
        background: #f9f9f9;
        border-radius: 4px;
      }

      #local-image-section,
      #url-image-section {
        transition: all 0.3s ease;
      }

      .image-option {
        margin-bottom: 15px;
      }

      .image-option label {
        display: inline;
        margin-left: 5px;
      }

      .preview-container {
        margin-top: 10px;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 4px;
        text-align: center;
      }

      /* Login Page Styles */
      .login-container {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 60vh;
      }

      .login-form {
        background-color: white;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        width: 100%;
        max-width: 400px;
      }

      .login-title {
        text-align: center;
        margin-bottom: 25px;
        color: #2c3e50;
      }

      .error-message {
        color: #e74c3c;
        text-align: center;
        margin-top: 15px;
        padding: 10px;
        background-color: #ffeaea;
        border-radius: 4px;
        display: none;
      }

      /* Contact Modal Styles */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        justify-content: center;
        align-items: center;
      }

      .modal.active {
        display: flex;
      }

      .modal-content {
        background-color: white;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        width: 90%;
        max-width: 500px;
        max-height: 90vh;
        overflow-y: auto;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid #eee;
      }

      .modal-title {
        font-size: 1.5rem;
        color: #2c3e50;
      }

      .close-modal {
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: #7f8c8d;
      }

      .close-modal:hover {
        color: #e74c3c;
      }

      /* Orders Page Styles */
      .orders-list {
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        margin-bottom: 30px;
      }

      .order-item {
        padding: 20px;
        border-bottom: 1px solid #eee;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .order-item:last-child {
        border-bottom: none;
      }

      .order-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
      }

      .order-customer {
        font-weight: bold;
        color: #2c3e50;
      }

      .order-date {
        color: #7f8c8d;
        font-size: 0.9rem;
      }

      .order-product {
        margin-bottom: 5px;
      }

      .order-contact {
        color: #7f8c8d;
        font-size: 0.9rem;
      }

      .no-orders {
        padding: 40px;
        text-align: center;
        color: #7f8c8d;
      }

      .order-details {
        flex-grow: 1;
      }

      .order-actions {
        display: flex;
        gap: 10px;
      }

      /* Customer Orders Page */
      .customer-orders {
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        padding: 25px;
        max-width: 800px;
        margin: 0 auto;
      }

      .customer-order-item {
        padding: 15px;
        border-bottom: 1px solid #eee;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .customer-order-item:last-child {
        border-bottom: none;
      }

      .order-status {
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: bold;
      }

      .status-pending {
        background-color: #fff3cd;
        color: #856404;
      }

      .status-processing {
        background-color: #cce7ff;
        color: #004085;
      }

      .status-shipped {
        background-color: #d1ecf1;
        color: #0c5460;
      }

      .status-delivered {
        background-color: #d4edda;
        color: #155724;
      }

      /* Admin Controls */
      .admin-controls {
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
        align-items: center;
      }

      .tabs {
        display: flex;
        margin-bottom: 20px;
        border-bottom: 1px solid #ddd;
      }

      .tab {
        padding: 10px 20px;
        cursor: pointer;
        border-bottom: 3px solid transparent;
      }

      .tab.active {
        border-bottom: 3px solid #3498db;
        color: #3498db;
        font-weight: bold;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      /* Footer Styles */
      footer {
        background-color: #2c3e50;
        color: white;
        text-align: center;
        padding: 20px 0;
        margin-top: 40px;
      }

      /* Responsive Styles */
      @media (max-width: 768px) {
        .header-content {
          flex-direction: column;
          text-align: center;
        }

        nav ul {
          margin-top: 15px;
          justify-content: center;
        }

        nav ul li {
          margin: 0 10px;
        }

        .products-grid {
          grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        }

        .admin-controls {
          flex-direction: column;
          gap: 10px;
        }

        .order-item {
          flex-direction: column;
          align-items: flex-start;
        }

        .order-actions {
          margin-top: 10px;
          width: 100%;
          justify-content: flex-end;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header>
      <div class="container header-content">
        <div class="logo">TRENCH CLOTHING</div>
        <nav>
          <ul>
            <li>
              <a href="#" class="nav-link active" data-page="store">Store</a>
            </li>
            <li>
              <a href="#" class="nav-link" data-page="customer-orders"
                >My Orders</a
              >
            </li>
            <li>
              <a href="#" class="nav-link" data-page="login" id="admin-nav"
                >Admin</a
              >
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <!-- Main Content -->
    <main class="container">
      <!-- Store Page -->
      <section id="store" class="page active">
        <h1 class="page-title">Our T-Shirt Collection</h1>
        <p class="iden">Grab quality T-shirts with awful designs</p>
        <div class="products-grid" id="products-container">
          <!-- Products will be dynamically added here -->
        </div>
      </section>

      <!-- Customer Orders Page -->
      <section id="customer-orders" class="page">
        <h1 class="page-title">My Orders</h1>
        <div class="customer-orders" id="customer-orders-container">
          <!-- Customer orders will be dynamically added here -->
        </div>
      </section>

      <!-- Login Page -->
      <section id="login" class="page">
        <div class="login-container">
          <div class="login-form">
            <h2 class="login-title">Admin Login</h2>
            <form id="login-form">
              <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" required />
              </div>
              <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" required />
              </div>
              <button type="submit" class="btn btn-primary" style="width: 100%">
                Login
              </button>
            </form>
            <div class="error-message" id="login-error">
              Invalid username or password
            </div>
          </div>
        </div>
      </section>

      <!-- Admin Page -->
      <section id="admin" class="page">
        <div class="admin-controls">
          <h1 class="page-title">Admin Panel</h1>
          <button class="btn btn-secondary" id="logout-btn">Logout</button>
        </div>

        <div class="tabs">
          <div class="tab active" data-tab="products">Manage Products</div>
          <div class="tab" data-tab="orders">Customer Orders</div>
        </div>

        <!-- Products Tab -->
        <div class="tab-content active" id="products-tab">
          <div class="admin-form">
            <form id="product-form">
              <div class="form-group">
                <label for="product-name">Product Name</label>
                <input type="text" id="product-name" required />
              </div>
              <div class="form-group">
                <label for="product-price">Price (GH₵)</label>
                <input
                  type="number"
                  id="product-price"
                  step="0.01"
                  min="0"
                  required
                />
              </div>
              <div class="form-group">
                <label for="product-description">Description</label>
                <textarea id="product-description" required></textarea>
              </div>

              <!-- Updated Image Selection Section -->
              <div class="form-group">
                <label>Product Image</label>
                <div style="margin-bottom: 15px">
                  <input
                    type="radio"
                    id="image-type-local"
                    name="image-type"
                    value="local"
                    checked
                  />
                  <label
                    for="image-type-local"
                    style="display: inline; margin-left: 5px"
                    >Upload Local Image</label
                  >

                  <input
                    type="radio"
                    id="image-type-url"
                    name="image-type"
                    value="url"
                    style="margin-left: 20px"
                  />
                  <label
                    for="image-type-url"
                    style="display: inline; margin-left: 5px"
                    >Use Online Image URL</label
                  >
                </div>

                <!-- Local Image Upload -->
                <div id="local-image-section">
                  <input
                    type="file"
                    id="product-image-local"
                    accept="image/*"
                    style="margin-bottom: 10px"
                  />
                  <div
                    id="image-preview"
                    style="margin-top: 10px; display: none"
                  >
                    <img
                      id="preview-img"
                      src="#"
                      alt="Preview"
                      style="
                        max-width: 200px;
                        max-height: 200px;
                        border: 1px solid #ddd;
                        border-radius: 4px;
                      "
                    />
                  </div>
                </div>

                <!-- Online Image URL -->
                <div id="url-image-section" style="display: none">
                  <input
                    type="url"
                    id="product-image-url"
                    placeholder="https://example.com/image.jpg"
                  />
                  <div id="url-preview" style="margin-top: 10px; display: none">
                    <img
                      id="url-preview-img"
                      src="#"
                      alt="URL Preview"
                      style="
                        max-width: 200px;
                        max-height: 200px;
                        border: 1px solid #ddd;
                        border-radius: 4px;
                      "
                    />
                  </div>
                </div>
              </div>

              <div class="form-buttons">
                <button type="button" class="btn btn-secondary" id="clear-form">
                  Clear
                </button>
                <button type="submit" class="btn btn-primary">
                  Add Product
                </button>
              </div>
            </form>
          </div>

          <!-- Current Products List -->
          <div style="margin-top: 40px">
            <h2 class="page-title">Current Products</h2>
            <div class="products-grid" id="admin-products-container">
              <!-- Admin products will be displayed here -->
            </div>
          </div>
        </div>

        <!-- Orders Tab -->
        <div class="tab-content" id="orders-tab">
          <h2 class="page-title">All Customer Orders</h2>
          <div class="orders-list" id="orders-container">
            <!-- Orders will be dynamically added here -->
          </div>
        </div>
      </section>
    </main>

    <!-- Contact Modal -->
    <div class="modal" id="contact-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">Contact Information</h2>
          <button class="close-modal">&times;</button>
        </div>
        <form id="contact-form">
          <div class="form-group">
            <label for="customer-name">Full Name</label>
            <input type="text" id="customer-name" required />
          </div>
          <div class="form-group">
            <label for="customer-email">Email Address</label>
            <input type="email" id="customer-email" required />
          </div>
          <div class="form-group">
            <label for="customer-phone">Phone Number</label>
            <input type="tel" id="customer-phone" required />
          </div>
          <div class="form-group">
            <label>Selected Product</label>
            <p
              id="selected-product-info"
              style="
                padding: 10px;
                background-color: #f8f9fa;
                border-radius: 4px;
              "
            ></p>
          </div>
          <div class="form-buttons">
            <button type="button" class="btn btn-secondary" id="cancel-order">
              Cancel
            </button>
            <button type="submit" class="btn btn-primary">
              Complete Order
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Footer -->
    <footer>
      <div class="container">
        <p>&copy; 2025 Trench Clothing. All rights reserved.</p>
        <p>Cotacts:</p>
      </div>
    </footer>

    <script>
      // Save products to localStorage
      function saveProductsToStorage() {
        localStorage.setItem("tShirtStoreProducts", JSON.stringify(products));
      }

      // Load products from localStorage
      function loadProductsFromStorage() {
        const savedProducts = localStorage.getItem("tShirtStoreProducts");
        if (savedProducts) {
          products = JSON.parse(savedProducts);
        } else {
          // Only set sample products if no products exist
          products = [
            {
              id: 1,
              name: "Classic White T-Shirt",
              price: 19.99,
              description:
                "A comfortable and versatile white t-shirt made from 100% cotton.",
              image:
                "https://via.placeholder.com/300x300/FFFFFF/000000?text=White+T-Shirt",
            },
            {
              id: 2,
              name: "Black Premium T-Shirt",
              price: 24.99,
              description: "Premium quality black t-shirt with a modern fit.",
              image:
                "https://via.placeholder.com/300x300/000000/FFFFFF?text=Black+T-Shirt",
            },
            {
              id: 3,
              name: "Blue Graphic T-Shirt",
              price: 29.99,
              description: "Stylish blue t-shirt with a unique graphic print.",
              image:
                "https://via.placeholder.com/300x300/0000FF/FFFFFF?text=Blue+T-Shirt",
            },
          ];
          saveProductsToStorage();
        }
      }

      // Save orders to localStorage
      function saveOrdersToStorage() {
        localStorage.setItem("tShirtStoreOrders", JSON.stringify(orders));
      }

      // Load orders from localStorage
      function loadOrdersFromStorage() {
        const savedOrders = localStorage.getItem("tShirtStoreOrders");
        if (savedOrders) {
          orders = JSON.parse(savedOrders);
        }
      }

      // Products storage - will be loaded from localStorage
      let products = [];

      // Orders storage
      let orders = [];

      // Current customer identifier (in a real app, this would come from authentication)
      let currentCustomerId = "customer-" + Math.floor(Math.random() * 10000);

      // Admin credentials (in a real app, this would be on a server)
      const adminCredentials = {
        username: "admin",
        password: "password123",
      };

      // Check if user is logged in
      let isLoggedIn = false;

      // DOM Elements
      const storePage = document.getElementById("store");
      const customerOrdersPage = document.getElementById("customer-orders");
      const loginPage = document.getElementById("login");
      const adminPage = document.getElementById("admin");
      const productsContainer = document.getElementById("products-container");
      const ordersContainer = document.getElementById("orders-container");
      const customerOrdersContainer = document.getElementById(
        "customer-orders-container"
      );
      const adminProductsContainer = document.getElementById(
        "admin-products-container"
      );
      const productForm = document.getElementById("product-form");
      const loginForm = document.getElementById("login-form");
      const clearFormBtn = document.getElementById("clear-form");
      const logoutBtn = document.getElementById("logout-btn");
      const navLinks = document.querySelectorAll(".nav-link");
      const adminNav = document.getElementById("admin-nav");
      const contactModal = document.getElementById("contact-modal");
      const contactForm = document.getElementById("contact-form");
      const closeModalBtn = document.querySelector(".close-modal");
      const cancelOrderBtn = document.getElementById("cancel-order");
      const selectedProductInfo = document.getElementById(
        "selected-product-info"
      );
      const loginError = document.getElementById("login-error");
      const tabs = document.querySelectorAll(".tab");
      const tabContents = document.querySelectorAll(".tab-content");

      // Current product selected for ordering
      let currentProduct = null;

      // Navigation
      navLinks.forEach((link) => {
        link.addEventListener("click", (e) => {
          e.preventDefault();
          let targetPage = link.getAttribute("data-page");

          // If trying to access admin without login, redirect to login
          if (targetPage === "admin" && !isLoggedIn) {
            targetPage = "login";
          }

          // Update active nav link
          navLinks.forEach((navLink) => navLink.classList.remove("active"));
          link.classList.add("active");

          // Show target page
          document.querySelectorAll(".page").forEach((page) => {
            page.classList.remove("active");
          });
          document.getElementById(targetPage).classList.add("active");

          // If customer orders page, refresh display
          if (targetPage === "customer-orders") {
            displayCustomerOrders();
          }

          // If admin page and logged in, refresh admin products
          if (targetPage === "admin" && isLoggedIn) {
            displayAdminProducts();
          }
        });
      });

      // Tab navigation
      tabs.forEach((tab) => {
        tab.addEventListener("click", () => {
          const tabId = tab.getAttribute("data-tab");

          // Update active tab
          tabs.forEach((t) => t.classList.remove("active"));
          tab.classList.add("active");

          // Show corresponding content
          tabContents.forEach((content) => {
            content.classList.remove("active");
            if (content.id === `${tabId}-tab`) {
              content.classList.add("active");
            }
          });

          // If orders tab, refresh orders display
          if (tabId === "orders") {
            displayOrders();
          }

          // If products tab, refresh admin products display
          if (tabId === "products") {
            displayAdminProducts();
          }
        });
      });

      // Image type toggle functionality
      document
        .getElementById("image-type-local")
        .addEventListener("change", function () {
          if (this.checked) {
            document.getElementById("local-image-section").style.display =
              "block";
            document.getElementById("url-image-section").style.display = "none";
            document.getElementById("product-image-url").required = false;
            document.getElementById("product-image-local").required = true;
          }
        });

      document
        .getElementById("image-type-url")
        .addEventListener("change", function () {
          if (this.checked) {
            document.getElementById("local-image-section").style.display =
              "none";
            document.getElementById("url-image-section").style.display =
              "block";
            document.getElementById("product-image-local").required = false;
            document.getElementById("product-image-url").required = true;
          }
        });

      // Local image preview
      document
        .getElementById("product-image-local")
        .addEventListener("change", function (e) {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
              document.getElementById("preview-img").src = e.target.result;
              document.getElementById("image-preview").style.display = "block";
            };
            reader.readAsDataURL(file);
          } else {
            document.getElementById("image-preview").style.display = "none";
          }
        });

      // URL image preview
      document
        .getElementById("product-image-url")
        .addEventListener("input", function (e) {
          const url = e.target.value;
          if (url && isValidUrl(url)) {
            document.getElementById("url-preview-img").src = url;
            document.getElementById("url-preview").style.display = "block";

            // Check if image loads successfully
            document.getElementById("url-preview-img").onerror = function () {
              document.getElementById("url-preview").style.display = "none";
              alert(
                "Cannot load image from the provided URL. Please check the URL and try again."
              );
            };

            document.getElementById("url-preview-img").onload = function () {
              document.getElementById("url-preview").style.display = "block";
            };
          } else {
            document.getElementById("url-preview").style.display = "none";
          }
        });

      // URL validation function
      function isValidUrl(string) {
        try {
          new URL(string);
          return true;
        } catch (_) {
          return false;
        }
      }

      // Display products
      function displayProducts() {
        productsContainer.innerHTML = "";

        products.forEach((product) => {
          const productCard = document.createElement("div");
          productCard.className = "product-card";

          productCard.innerHTML = `
                    <img src="${product.image}" alt="${
            product.name
          }" class="product-image" onerror="this.src='data:image/svg+xml;charset=UTF-8,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22250%22 height=%22250%22 viewBox=%220 0 250 250%22%3E%3Crect fill=%22%23f8f9fa%22 width=%22250%22 height=%22250%22/%3E%3Ctext fill=%22%236c757d%22 font-family=%22Arial%22 font-size=%2218%22 text-anchor=%22middle%22 x=%22125%22 y=%22125%22%3ET-Shirt Image%3C/text%3E%3C/svg%3E'">
                    <div class="product-info">
                        <h3 class="product-title">${product.name}</h3>
                        <p class="product-price">GH₵${product.price.toFixed(
                          2
                        )}</p>
                        <p class="product-description">${
                          product.description
                        }</p>
                        <button class="add-to-cart" data-id="${
                          product.id
                        }">Add to Cart</button>
                    </div>
                `;

          productsContainer.appendChild(productCard);
        });

        // Add event listeners to "Add to Cart" buttons
        document.querySelectorAll(".add-to-cart").forEach((button) => {
          button.addEventListener("click", (e) => {
            const productId = parseInt(e.target.getAttribute("data-id"));
            showContactForm(productId);
          });
        });
      }

      // Display products in admin panel
      function displayAdminProducts() {
        adminProductsContainer.innerHTML = "";

        products.forEach((product) => {
          const productCard = document.createElement("div");
          productCard.className = "product-card";

          productCard.innerHTML = `
                    <img src="${product.image}" alt="${
            product.name
          }" class="product-image" onerror="this.src='data:image/svg+xml;charset=UTF-8,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22250%22 height=%22250%22 viewBox=%220 0 250 250%22%3E%3Crect fill=%22%23f8f9fa%22 width=%22250%22 height=%22250%22/%3E%3Ctext fill=%22%236c757d%22 font-family=%22Arial%22 font-size=%2218%22 text-anchor=%22middle%22 x=%22125%22 y=%22125%22%3ET-Shirt Image%3C/text%3E%3C/svg%3E'">
                    <div class="product-info">
                        <h3 class="product-title">${product.name}</h3>
                        <p class="product-price">$${product.price.toFixed(
                          2
                        )}</p>
                        <p class="product-description">${
                          product.description
                        }</p>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-secondary" onclick="editProduct(${
                              product.id
                            })" style="flex: 1;">Edit</button>
                            <button class="btn btn-danger" onclick="deleteProduct(${
                              product.id
                            })" style="flex: 1;">Delete</button>
                        </div>
                    </div>
                `;

          adminProductsContainer.appendChild(productCard);
        });
      }

      // Show contact form for product
      function showContactForm(productId) {
        currentProduct = products.find((p) => p.id === productId);
        if (currentProduct) {
          selectedProductInfo.textContent = `${
            currentProduct.name
          } - $${currentProduct.price.toFixed(2)}`;
          contactModal.classList.add("active");
        }
      }

      // Close modal
      function closeModal() {
        contactModal.classList.remove("active");
        currentProduct = null;
        contactForm.reset();
      }

      // Handle contact form submission
      contactForm.addEventListener("submit", (e) => {
        e.preventDefault();

        const name = document.getElementById("customer-name").value;
        const email = document.getElementById("customer-email").value;
        const phone = document.getElementById("customer-phone").value;

        // Create new order
        const newOrder = {
          id: orders.length > 0 ? Math.max(...orders.map((o) => o.id)) + 1 : 1,
          productId: currentProduct.id,
          productName: currentProduct.name,
          productPrice: currentProduct.price,
          customerName: name,
          customerEmail: email,
          customerPhone: phone,
          customerId: currentCustomerId,
          date: new Date().toLocaleString(),
          status: "pending",
        };

        // Add to orders array
        orders.push(newOrder);

        // Save to localStorage
        saveOrdersToStorage();

        // Close modal
        closeModal();

        // Show success message
        alert("Thank you for your order! We will contact you soon.");
      });

      // Display all orders for admin
      function displayOrders() {
        ordersContainer.innerHTML = "";

        if (orders.length === 0) {
          ordersContainer.innerHTML =
            '<div class="no-orders">No orders yet</div>';
          return;
        }

        orders.forEach((order) => {
          const orderItem = document.createElement("div");
          orderItem.className = "order-item";

          orderItem.innerHTML = `
                    <div class="order-details">
                        <div class="order-header">
                            <span class="order-customer">${
                              order.customerName
                            }</span>
                            <span class="order-date">${order.date}</span>
                        </div>
                        <div class="order-product">
                            <strong>Product:</strong> ${
                              order.productName
                            } - $${order.productPrice.toFixed(2)}
                        </div>
                        <div class="order-contact">
                            <strong>Contact:</strong> ${
                              order.customerEmail
                            } | ${order.customerPhone}
                        </div>
                        <div class="order-status">
                            <span class="order-status status-${order.status}">${
            order.status.charAt(0).toUpperCase() + order.status.slice(1)
          }</span>
                        </div>
                    </div>
                    <div class="order-actions">
                        <button class="btn btn-primary" data-id="${
                          order.id
                        }" data-action="update-status">Update Status</button>
                        <button class="btn btn-danger" data-id="${
                          order.id
                        }" data-action="delete">Delete</button>
                    </div>
                `;

          ordersContainer.appendChild(orderItem);
        });

        // Add event listeners to order action buttons
        document.querySelectorAll(".order-actions button").forEach((button) => {
          button.addEventListener("click", (e) => {
            const orderId = parseInt(e.target.getAttribute("data-id"));
            const action = e.target.getAttribute("data-action");

            if (action === "update-status") {
              updateOrderStatus(orderId);
            } else if (action === "delete") {
              deleteOrder(orderId);
            }
          });
        });
      }

      // Display customer's own orders
      function displayCustomerOrders() {
        customerOrdersContainer.innerHTML = "";

        const customerOrders = orders.filter(
          (order) => order.customerId === currentCustomerId
        );

        if (customerOrders.length === 0) {
          customerOrdersContainer.innerHTML =
            '<div class="no-orders">You have no orders yet</div>';
          return;
        }

        customerOrders.forEach((order) => {
          const orderItem = document.createElement("div");
          orderItem.className = "customer-order-item";

          orderItem.innerHTML = `
                    <div>
                        <div class="order-product">
                            <strong>${
                              order.productName
                            }</strong> - $${order.productPrice.toFixed(2)}
                        </div>
                        <div class="order-date">Ordered on: ${order.date}</div>
                    </div>
                    <div>
                        <span class="order-status status-${order.status}">${
            order.status.charAt(0).toUpperCase() + order.status.slice(1)
          }</span>
                    </div>
                `;

          customerOrdersContainer.appendChild(orderItem);
        });
      }

      // Update order status
      function updateOrderStatus(orderId) {
        const order = orders.find((o) => o.id === orderId);
        if (order) {
          const statuses = ["pending", "processing", "shipped", "delivered"];
          const currentIndex = statuses.indexOf(order.status);
          const nextIndex = (currentIndex + 1) % statuses.length;
          order.status = statuses[nextIndex];

          // Save to localStorage
          saveOrdersToStorage();

          displayOrders();
          displayCustomerOrders();
        }
      }

      // Delete order
      function deleteOrder(orderId) {
        if (confirm("Are you sure you want to delete this order?")) {
          orders = orders.filter((o) => o.id !== orderId);
          // Save to localStorage
          saveOrdersToStorage();
          displayOrders();
          displayCustomerOrders();
        }
      }

      // Handle login form submission
      loginForm.addEventListener("submit", (e) => {
        e.preventDefault();

        const username = document.getElementById("username").value;
        const password = document.getElementById("password").value;

        // Check credentials
        if (
          username === adminCredentials.username &&
          password === adminCredentials.password
        ) {
          isLoggedIn = true;
          loginError.style.display = "none";

          // Switch to admin page
          document.querySelectorAll(".page").forEach((page) => {
            page.classList.remove("active");
          });
          adminPage.classList.add("active");

          // Update nav
          navLinks.forEach((navLink) => {
            navLink.classList.remove("active");
            if (navLink.getAttribute("data-page") === "admin") {
              navLink.classList.add("active");
            }
          });

          // Update admin nav text
          adminNav.textContent = "Admin Panel";

          // Display orders and products in admin panel
          displayOrders();
          displayAdminProducts();
        } else {
          loginError.style.display = "block";
        }
      });

      // Handle logout
      logoutBtn.addEventListener("click", () => {
        isLoggedIn = false;

        // Switch to store page
        document.querySelectorAll(".page").forEach((page) => {
          page.classList.remove("active");
        });
        storePage.classList.add("active");

        // Update nav
        navLinks.forEach((navLink) => {
          navLink.classList.remove("active");
          if (navLink.getAttribute("data-page") === "store") {
            navLink.classList.add("active");
          }
        });

        // Reset admin nav text
        adminNav.textContent = "Admin";

        // Clear login form
        loginForm.reset();
        loginError.style.display = "none";
      });

      // Updated product form submission
      productForm.addEventListener("submit", (e) => {
        e.preventDefault();

        const name = document.getElementById("product-name").value;
        const price = parseFloat(
          document.getElementById("product-price").value
        );
        const description = document.getElementById(
          "product-description"
        ).value;

        let image = "";
        const imageType = document.querySelector(
          'input[name="image-type"]:checked'
        ).value;

        if (imageType === "local") {
          const fileInput = document.getElementById("product-image-local");
          if (fileInput.files.length > 0) {
            const file = fileInput.files[0];
            // Convert local file to data URL for storage
            const reader = new FileReader();
            reader.onload = function (e) {
              image = e.target.result;
              addProductToStore(name, price, description, image);
            };
            reader.readAsDataURL(file);
          } else {
            alert("Please select a local image file");
            return;
          }
        } else {
          image = document.getElementById("product-image-url").value;
          if (!image) {
            alert("Please enter an image URL");
            return;
          }
          addProductToStore(name, price, description, image);
        }
      });

      // Function to add product to store
      function addProductToStore(name, price, description, image) {
        // Create new product
        const newProduct = {
          id:
            products.length > 0
              ? Math.max(...products.map((p) => p.id)) + 1
              : 1,
          name,
          price,
          description,
          image,
        };

        // Add to products array
        products.push(newProduct);

        // Save to localStorage
        saveProductsToStorage();

        // Update displays
        displayProducts();
        displayAdminProducts();

        // Reset form
        productForm.reset();
        document.getElementById("image-preview").style.display = "none";
        document.getElementById("url-preview").style.display = "none";
        document.getElementById("image-type-local").checked = true;
        document.getElementById("local-image-section").style.display = "block";
        document.getElementById("url-image-section").style.display = "none";

        // Show success message
        alert("Product added successfully!");
      }

      // Edit product function
      function editProduct(productId) {
        const product = products.find((p) => p.id === productId);
        if (product) {
          // Fill form with product data
          document.getElementById("product-name").value = product.name;
          document.getElementById("product-price").value = product.price;
          document.getElementById("product-description").value =
            product.description;

          // Determine if image is local or URL
          if (product.image.startsWith("data:image")) {
            document.getElementById("image-type-local").checked = true;
            document.getElementById("local-image-section").style.display =
              "block";
            document.getElementById("url-image-section").style.display = "none";
            document.getElementById("preview-img").src = product.image;
            document.getElementById("image-preview").style.display = "block";
          } else {
            document.getElementById("image-type-url").checked = true;
            document.getElementById("local-image-section").style.display =
              "none";
            document.getElementById("url-image-section").style.display =
              "block";
            document.getElementById("product-image-url").value = product.image;
            document.getElementById("url-preview-img").src = product.image;
            document.getElementById("url-preview").style.display = "block";
          }

          // Remove the product being edited
          products = products.filter((p) => p.id !== productId);

          // Save to localStorage
          saveProductsToStorage();

          // Update displays
          displayProducts();
          displayAdminProducts();

          alert(
            'Product loaded for editing. Make your changes and click "Add Product" to update.'
          );
        }
      }

      // Delete product function
      function deleteProduct(productId) {
        if (confirm("Are you sure you want to delete this product?")) {
          products = products.filter((p) => p.id !== productId);
          // Save to localStorage after deletion
          saveProductsToStorage();
          displayProducts();
          displayAdminProducts();
          alert("Product deleted successfully!");
        }
      }

      // Update clear form function
      clearFormBtn.addEventListener("click", () => {
        productForm.reset();
        document.getElementById("image-preview").style.display = "none";
        document.getElementById("url-preview").style.display = "none";
        document.getElementById("image-type-local").checked = true;
        document.getElementById("local-image-section").style.display = "block";
        document.getElementById("url-image-section").style.display = "none";
      });

      // Event listeners for modal
      closeModalBtn.addEventListener("click", closeModal);
      cancelOrderBtn.addEventListener("click", closeModal);

      // Close modal when clicking outside
      contactModal.addEventListener("click", (e) => {
        if (e.target === contactModal) {
          closeModal();
        }
      });

      // Initialize the page
      loadProductsFromStorage();
      loadOrdersFromStorage();
      displayProducts();
      displayCustomerOrders();
    </script>
  </body>
</html>
